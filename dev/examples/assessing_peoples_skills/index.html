<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Assessing Peoples Skills · ReactiveMP.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ReactiveMP.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><span class="tocitem">User guide</span><ul><li><a class="tocitem" href="../../man/getting-started/">Getting Started</a></li><li><a class="tocitem" href="../../man/model-specification/">Model Specification</a></li><li><a class="tocitem" href="../../man/constraints-specification/">Constraints Specification</a></li><li><a class="tocitem" href="../../man/meta-specification/">Meta Specification</a></li><li><a class="tocitem" href="../../man/inference-execution/">Inference execution</a></li><li><a class="tocitem" href="../../man/advanced-tutorial/">Advanced Tutorial</a></li></ul></li><li><span class="tocitem">Custom functionality</span><ul><li><a class="tocitem" href="../../custom/custom-functional-form/">Custom functional form</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/message/">Messages</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Factor nodes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/nodes/nodes/">Overview</a></li><li><a class="tocitem" href="../../lib/nodes/flow/">Flow</a></li></ul></li><li><a class="tocitem" href="../../lib/form/">Functional forms</a></li><li><a class="tocitem" href="../../lib/prod/">Prod implementation</a></li><li><a class="tocitem" href="../../lib/math/">Math utils</a></li><li><a class="tocitem" href="../../lib/helpers/">Helper utils</a></li><li><a class="tocitem" href="../../lib/methods/">Exported methods</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../linear_regression/">Linear Regression</a></li><li class="is-active"><a class="tocitem" href>Assessing Peoples Skills</a><ul class="internal"><li><a class="tocitem" href="#Assessing-People’s-Skills"><span>Assessing People’s Skills</span></a></li></ul></li><li><a class="tocitem" href="../linear_gaussian_state_space_model/">Linear Gaussian Dynamical System</a></li><li><a class="tocitem" href="../hidden_markov_model/">Hidden Markov Model</a></li><li><a class="tocitem" href="../hierarchical_gaussian_filter/">Hierarchical Gaussian Filter</a></li><li><a class="tocitem" href="../autoregressive/">Autoregressive Model</a></li><li><a class="tocitem" href="../invertible_neural_network_tutorial/">Invertible Neural Networks</a></li><li><a class="tocitem" href="../univariate_normal_mixture/">Univariate Normal Mixture</a></li><li><a class="tocitem" href="../multivariate_normal_mixture/">Multivariate Normal Mixture</a></li><li><a class="tocitem" href="../gamma_mixture/">Gamma Mixture</a></li><li><a class="tocitem" href="../custom_nonlinear_node/">Custom Nonlinear Node</a></li><li><a class="tocitem" href="../missing_data/">Missing data</a></li><li><a class="tocitem" href="../probit/">Expectation Propagation (Probit)</a></li></ul></li><li><a class="tocitem" href="../../extra/contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Assessing Peoples Skills</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Assessing Peoples Skills</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/biaslab/ReactiveMP.jl/blob/master/docs/src/examples/assessing_peoples_skills.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h2 id="Assessing-People’s-Skills"><a class="docs-heading-anchor" href="#Assessing-People’s-Skills">Assessing People’s Skills</a><a id="Assessing-People’s-Skills-1"></a><a class="docs-heading-anchor-permalink" href="#Assessing-People’s-Skills" title="Permalink"></a></h2><p>This demo demonstrates the capabilities of ReactiveMP.jl to perform inference in the models composed of Bernoulli random variables.</p><p>The demo is inspired by the example from Chapter 2 of Bishop&#39;s Model-Based Machine Learning book. We are going to perform an exact inference to assess the skills of a student given the results of the test.</p><p>Let us assume that our imaginary test is composed of three questions, and each of these questions is associated with test results <span>$r$</span>, where <span>$\{r \in \mathbb{R}, 0 &lt; r &lt; 1\}$</span></p><p>The result of the first question will solely depend on the student&#39;s attendance. For example, if the student attends the lectures, he will most certainly answer the first question. The result of the second question will depend on a specific skill <span>$s_2$</span>. However, if the student has attended the lectures, he would still have a good chance of answering the second question. We will model this relationship through disjunction or logical <span>$OR$</span>. The third question is more difficult to answer, i.e., the student needs to have a particular skill <span>$s_3$</span> <strong>and</strong> he must have good attendance or must have a <span>$s_3$</span> Hence, to model this relationship between skills and the third question, we will use conjunction or logical <span>$AND$</span>.</p><p>For the sake of the example, we will replace attendance with laziness. The convention is that if a person is not lazy, he attends lectures. This way, the first question can be answered if the student is not lazy. We will use the <span>$NOT$</span> function to represent this relationship.</p><p>Let us define the generative model: <span>$p(l, s_2, s_3, r_1, r_2, r_3)=p(l)p(s_2)p(s_3)p(r_1|f_1(l))p(r_2|f_2(l, s_2))p(r_3|f_3(l, s_2, s_3))$</span></p><p>The factors <span>$p(l), p(s_2), p(s_3)$</span> represent Bernoulli prior distributions. </p><p class="math-container">\[f_1(l) = NOT(l)\]</p><p>where <span>$NOT(X) \triangleq \overline{X}$</span>, </p><p class="math-container">\[f_2(l, s_2) = OR(NOT(l), s_2)\]</p><p>where <span>$OR(X, Y) \triangleq X \vee Y$</span>, </p><p class="math-container">\[f_3(l, s_2, s_3) = AND(OR(NOT(l), s_2), s_3)\]</p><p>where <span>$AND(X, Y) \triangleq X \land Y$</span></p><p>An attentive reader may notice that <span>$f_2(l, s_2)$</span> can be rewritten as <span>$IMPLY(l, s_2)$</span>, i.e., <span>$l\implies s_2$</span> </p><p>Similar to the example from the Model-Based Machine Learning book, our observations are noisy. It means that the likelihood functions should map <span>$\{0, 1\}$</span> to a real value <span>$r \in (0, 1)$</span>, denoting the result of the test. We can associate <span>$r=0$</span> and <span>$r=1.0$</span> with <span>$0\%$</span> and <span>$100\%$</span> correctness of the test, respectively.</p><p>One way of specifying the likelihood is <span>$p(r_i|f) = \begin{cases} r_i &amp; \text{if }f_i = 1 \\
1-r_i &amp; \text{if }f_i=0 \end{cases}$</span> or <span>$p(r_i|f)=r_if_i+(1-r_i)(1-f_i)$</span></p><p>It can be shown that given the observation <span>$r_i$</span>, the backward message from the node <span>$p(r_i|f_i)$</span> will be a Bernoulli distribution with parameter <span>$r_i$</span>, i.e. <span>$\overleftarrow{\mu}({f_i})\propto\mathrm{Ber}(r_i)$</span>.  If we observe <span>$r_i=0.9$</span> it is more &quot;likely&quot; that the variable <span>$f_i=1$</span>.</p><p>Following Bishop, we will call this node function <strong>AddNoise</strong></p><pre><code class="language-julia hljs">using Rocket, GraphPPL, ReactiveMP, Distributions, Random</code></pre><pre><code class="language-julia hljs"># Create AddNoise node
struct AddNoise end

@node AddNoise Stochastic [out, in]</code></pre><pre><code class="language-julia hljs"># Adding update rule for AddNoise node
@rule AddNoise(:in, Marginalisation) (q_out::PointMass,) = begin
    return Bernoulli(mean(q_out))
end</code></pre><pre><code class="language-julia hljs"># GraphPPL.jl export `@model` macro for model specification
# It accepts a regular Julia function and builds an FFG under the hood
@model function skill_model()

    res = datavar(Float64, 3)

    laziness ~ Bernoulli(0.5)
    skill2 ~ Bernoulli(0.5)
    skill3 ~ Bernoulli(0.5)

    test2 ~ laziness -&gt; skill2
    test3 ~ test2 &amp;&amp; skill3

    res[1] ~ AddNoise(¬laziness)
    res[2] ~ AddNoise(test2)
    res[3] ~ AddNoise(test3)

end</code></pre><p>Let us assume that a student scoared <span>$70\%$</span> and <span>$95\%$</span> at first and second tests respectively. But got only <span>$30\%$</span> on the third one. </p><pre><code class="language-julia hljs">test_results = [0.7, 0.95, 0.3]

inference_result = inference(
    model = Model(skill_model),
    data  = (res = test_results, )
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Inference results:
-----------------------------------------
skill3   = Bernoulli{Float64}(p=0.3025672371638141)
skill2   = Bernoulli{Float64}(p=0.5806845965770171)
laziness = Bernoulli{Float64}(p=0.18704156479217607)
</code></pre><p>The results make sense. On the one hand, the student answered the first question correctly, which immediately gives us reason to believe that he is not lazy. He answered the second question pretty well, but this does not mean that the student had the skills to answer this question (attendance,i.e., lack of laziness, could help). To answer the third question, it was necessary to answer the second and have additional skills (#3). Unfortunately, the student&#39;s answer was weak, so our confidence about skill #3 was shattered.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../linear_regression/">« Linear Regression</a><a class="docs-footer-nextpage" href="../linear_gaussian_state_space_model/">Linear Gaussian Dynamical System »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 27 October 2022 09:02">Thursday 27 October 2022</span>. Using Julia version 1.8.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
